Topological sort, indegree, cycle detection